webpackJsonp([0],{K31e:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("mvHQ"),a=s.n(n),i={data:function(){return{login:{user:null,pass_rsa:null},register:{user:null,pass_rsa:null},uid:Date.now(),qqLoginUrl:"not url",page:"login"}},created:function(){this.$store.state.user&&history.back(-1),this.$connecter.$emit("page",{title:{tag:"登录",description:"欢迎回来 ~~~ "}}),this.page=null===this.$route.query.register?"register":"login",this.qqLoginUrl="https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101540984&redirect_uri=http%3A%2F%2Fmczyzy.cn%3A8080%2Fqqlogin%2Fcallback&state="+this.uid,this.$store.state.mobile&&(this.qqLoginUrl="https://xui.ptlogin2.qq.com/cgi-bin/xlogin?appid=716027609&pt_3rd_aid=101540984&daid=383&pt_skey_valid=0&style=35&s_url=http%3A%2F%2Fconnect.qq.com&refer_cgi=authorize&which=&client_id=101540984&redirect_uri=http%3A%2F%2Fmczyzy.cn%3A8080%2Fqqlogin%2Fcallback&response_type=code&state="+this.uid)},methods:{loginEvent:function(){var t=this,e={text:"登录成功,欢迎回来 ["+t.login.user+"]!",icon:"success",hideTime:4e3};t.login.user&&t.login.pass_rsa&&t.$http.get("user/login",t.login).then(function(s){window.localStorage.setItem("userInfo",a()(s.data)),t.$store.state.user=s.data,t.$connecter.$emit("page",{toast:e}),t.$router.push({path:"/"})}).catch(function(s){e.icon="error",e.text=s.data.error,t.$connecter.$emit("page",{toast:e})})},registerEvent:function(){var t=this,e={text:"注册成功, ["+t.login.user+"] 欢迎加入!",icon:"success",hideTime:4e3};t.register.user&&t.register.pass_rsa&&t.$http.get("user/register",t.register).then(function(s){window.localStorage.setItem("userInfo",a()(s.data)),t.$store.state.user=s.data,t.$connecter.$emit("page",{toast:e}),t.$router.push({path:"/"})}).catch(function(s){e.icon="error",e.text=s.data.error,t.$connecter.$emit("page",{toast:e})})},qqLogin:function(){var t={text:"QQ登录授权失败!",icon:"error",hideTime:4e3},e=this;function s(){window.addEventListener("focus",n);function n(){window.removeEventListener("blur",s);window.removeEventListener("focus",n);e.$http.get("qqLogin/exists",{uid:e.uid}).then(function(s){if(s.data.value){e.$store.state.user=JSON.parse(JSON.parse(s.data.value));t.icon="success";t.text="授权成功, 欢迎回来 ["+e.$store.state.user.nickname+"]!";e.$connecter.$emit("page",{toast:t})}else{t.text="授权失败, 回调值错误!";e.$connecter.$emit("page",{toast:t})}}).catch(function(){e.$connecter.$emit("page",{toast:t})})}}window.addEventListener("blur",function(){window.addEventListener("focus",function n(){window.removeEventListener("blur",s);window.removeEventListener("focus",n);e.$http.get("qqLogin/exists",{uid:e.uid}).then(function(s){s.data.value?(e.$store.state.user=JSON.parse(JSON.parse(s.data.value)),t.icon="success",t.text="授权成功, 欢迎回来 ["+e.$store.state.user.nickname+"]!",e.$connecter.$emit("page",{toast:t})):(t.text="授权失败, 回调值错误!",e.$connecter.$emit("page",{toast:t}))}).catch(function(){e.$connecter.$emit("page",{toast:t})})})})},togglepage:function(t){var e=t.target.dataset;e.page&&(this.page=e.page)}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-row single clearfix"},[s("div",{class:["account",{login:"login"==t.page}]},[s("img",{staticClass:"border-line",attrs:{src:"http://120.78.221.235/img/account-bg3.jpg",alt:"图1"}}),t._v(" "),s("form",{attrs:{action:""}},[s("label",[t._v("账号")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.login.user,expression:"login.user"}],staticClass:"input-1v",attrs:{type:"text",name:"log_user"},domProps:{value:t.login.user},on:{input:function(e){e.target.composing||t.$set(t.login,"user",e.target.value)}}}),t._v(" "),s("label",[t._v("密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.login.pass_rsa,expression:"login.pass_rsa"}],staticClass:"input-1v",attrs:{type:"password",name:"log_pass"},domProps:{value:t.login.pass_rsa},on:{input:function(e){e.target.composing||t.$set(t.login,"pass_rsa",e.target.value)}}}),t._v(" "),s("span",{staticClass:"button-v1",on:{click:t.loginEvent}},[t._v("登陆")])]),t._v(" "),s("span",{staticClass:"account-right"},[s("a",{attrs:{href:t.qqLoginUrl,target:"_black"},on:{click:t.qqLogin}},[s("i",{staticClass:"iconfont icon-ziyuan"}),t._v(" "),s("span",[t._v("QQ登录")])]),t._v(" "),s("a",[s("i",{staticClass:"iconfont icon-zhuce"}),t._v(" "),s("span",{attrs:{"data-page":"register"},on:{click:t.togglepage}},[t._v("注册账号")])])])]),t._v(" "),s("div",{class:["account",{register:"register"==t.page}]},[s("img",{staticClass:"border-line",attrs:{src:"http://120.78.221.235/img/account-bg3.jpg",alt:"图1"}}),t._v(" "),s("form",[s("label",[t._v("账号")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.register.user,expression:"register.user"}],attrs:{type:"text",placeholder:"用户名不能超过9位"},domProps:{value:t.register.user},on:{input:function(e){e.target.composing||t.$set(t.register,"user",e.target.value)}}}),t._v(" "),s("label",[t._v("密码")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.register.pass_rsa,expression:"register.pass_rsa"}],attrs:{type:"password",placeholder:"密码不能过短"},domProps:{value:t.register.pass_rsa},on:{input:function(e){e.target.composing||t.$set(t.register,"pass_rsa",e.target.value)}}}),t._v(" "),s("span",{staticClass:"button-v1",on:{click:t.registerEvent}},[t._v("注册")])]),t._v(" "),s("span",{staticClass:"account-right"},[s("a",{attrs:{href:t.qqLoginUrl,target:"_black"},on:{click:t.qqLogin}},[s("i",{staticClass:"iconfont icon-ziyuan"}),t._v(" "),s("span",[t._v("QQ登录")])]),t._v(" "),s("a",[s("i",{staticClass:"iconfont icon-zhuce"}),t._v(" "),s("span",{attrs:{"data-page":"login"},on:{click:t.togglepage}},[t._v("登录账号")])])])])])},staticRenderFns:[]};var o=s("VU/8")(i,r,!1,function(t){s("rlT5")},null,null);e.default=o.exports},mvHQ:function(t,e,s){t.exports={default:s("qkKv"),__esModule:!0}},qkKv:function(t,e,s){var n=s("FeBl"),a=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},rlT5:function(t,e){}});
//# sourceMappingURL=0.f103a989083438aa4068.js.map